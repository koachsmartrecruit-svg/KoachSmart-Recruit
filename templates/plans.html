{% extends "base.html" %}
{% block content %}

<div class="container py-5">

  <div class="text-center mb-5">
    <h2 class="fw-bold">Simple, Transparent Pricing</h2>
    <p class="text-muted">Choose the plan that fits your goals</p>
  </div>

  <div class="row justify-content-center g-4">

    <!-- FREE -->
    <div class="col-md-4">
      <div class="card h-100 shadow-sm">
        <div class="card-body text-center d-flex flex-column">
          <h4>Coach Basic</h4>
          <h1 class="fw-bold my-3">Free</h1>
          <ul class="list-unstyled text-start flex-grow-1">
            <li>✔ Create Profile</li>
            <li>✔ Apply to Jobs</li>
            <li class="text-muted">✖ Top Search</li>
          </ul>
          <a href="{{ url_for('dashboard') }}" class="btn btn-outline-dark w-100">
            Continue Free
          </a>
        </div>
      </div>
    </div>

    <!-- COACH PREMIUM -->
    <div class="col-md-4">
      <div class="card h-100 shadow border-success">
        <div class="card-body text-center d-flex flex-column">
          <h4 class="text-success">Coach Premium</h4>
          <h1 class="fw-bold my-3">₹1500/mo</h1>

          <ul class="list-unstyled text-start flex-grow-1">
            <li>✔ Top of Search</li>
            <li>✔ Profile Analytics</li>
            <li>✔ Priority Support</li>
          </ul>

          <button class="btn btn-success w-100"
                  onclick="openPaymentModal('Coach Premium',1500)">
            Choose Plan
          </button>
        </div>
      </div>
    </div>

    <!-- ACADEMY PRO -->
    <div class="col-md-4">
      <div class="card h-100 shadow border-primary">
        <div class="card-body text-center d-flex flex-column">
          <h4 class="text-primary">Academy Pro</h4>
          <h1 class="fw-bold my-3">₹4500/mo</h1>

          <ul class="list-unstyled text-start flex-grow-1">
            <li>✔ Unlimited Jobs</li>
            <li>✔ Verified Coaches</li>
            <li>✔ AI Tools</li>
          </ul>

          <button class="btn btn-primary w-100"
                  onclick="openPaymentModal('Academy Pro',4500)">
            Choose Plan
          </button>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ================= PAYMENT MODAL ================= -->
<div class="modal fade" id="paymentModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title" id="planTitle"></h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">

        <!-- PAYMENT TABS -->
        <ul class="nav nav-pills justify-content-center mb-4">
          <li class="nav-item">
            <button class="nav-link active">UPI</button>
          </li>
          <li class="nav-item">
            <button class="nav-link disabled">Net Banking</button>
          </li>
          <li class="nav-item">
            <button class="nav-link disabled">Card</button>
          </li>
        </ul>

        <!-- UPI SECTION -->
        <div class="text-center">
          <h4 class="fw-bold mb-2">Pay ₹<span id="planAmount"></span> via UPI</h4>

          <div id="upiQR" class="d-flex justify-content-center my-3"></div>

          <a id="upiLink" class="btn btn-success w-100 mb-2">
            Open UPI App
          </a>

          <button class="btn btn-outline-primary w-100"
                  onclick="confirmPayment()">
            I’ve completed payment
          </button>

          <small class="text-muted d-block mt-2">
            ⚠️ Test mode · No real money deducted
          </small>
        </div>

      </div>
    </div>
  </div>
</div>

<!-- QR LIB -->
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>

<script>
let qr;

function openPaymentModal(plan, amount) {
  document.getElementById("planTitle").innerText = plan;
  document.getElementById("planAmount").innerText = amount;

  const upiURL =
    `upi://pay?pa=koachsmart@upi&pn=KoachSmart&am=${amount}&cu=INR`;

  document.getElementById("upiLink").href = upiURL;

  document.getElementById("upiQR").innerHTML = "";
  qr = new QRCode(document.getElementById("upiQR"), {
    text: upiURL,
    width: 200,
    height: 200
  });

  new bootstrap.Modal(document.getElementById("paymentModal")).show();
}

function confirmPayment() {
  window.location.href = "/payment/success?mode=upi_test";
}
</script>

{% endblock %}

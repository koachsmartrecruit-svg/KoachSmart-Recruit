{% extends "base.html" %}

{% block content %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>select option { background-color: #0f172a; color: white; }</style>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-9">
            <div class="glass-card p-4 p-md-5">
                <h3 class="fw-bold mb-4">Post a New Job</h3>
                
                <form method="POST">
                    <div class="mb-3">
                        <label class="form-label text-muted small">Job Title</label>
                        <input type="text" class="form-control" name="title" value="{{ form_data.title if form_data else '' }}" required>
                    </div>

                    <div class="row g-3 mb-3">
                        <div class="col-md-6">
                            <label class="form-label text-muted small">Sport</label>
                            <select class="form-select" name="sport">
                                <option value="Cricket">Cricket</option>
                                <option value="Football">Football</option>
                                <option value="Tennis">Tennis</option>
                                <!-- ... add more sports ... -->
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label text-muted small">Venue Name</label>
                            <input type="text" class="form-control" name="location" value="{{ form_data.location if form_data else '' }}" required>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="form-label text-primary fw-bold">Pin Exact Location</label>
                        <div class="input-group mb-1">
                            <input type="text" id="addressInput" class="form-control" placeholder="Search Area (e.g. Shivaji Park)">
                            <button class="btn btn-outline-light" type="button" onclick="searchAddress()" id="searchBtn">Locate</button>
                        </div>
                        <div id="pickerMap" style="height: 250px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.2);"></div>
                        <input type="hidden" name="lat" id="lat" value="{{ form_data.lat if form_data else '' }}">
                        <input type="hidden" name="lng" id="lng" value="{{ form_data.lng if form_data else '' }}">
                    </div>

                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label class="form-label text-muted small">Description</label>
                            <textarea class="form-control" name="description" rows="4">{{ form_data.description if form_data else '' }}</textarea>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label text-muted small">Key Requirements</label>
                            <textarea class="form-control" name="requirements" rows="4" placeholder="e.g. Must have BCCI Level 1 cert, Own transport">{{ form_data.requirements if form_data else '' }}</textarea>
                        </div>
                    </div>

                    <!-- SCREENING QUESTIONS -->
                    <div class="mb-4 p-3 border border-secondary rounded bg-dark bg-opacity-25">
                        <label class="form-label text-info fw-bold"><i class="fas fa-filter me-2"></i>Screening Questions</label>
                        <p class="text-muted small mb-2">Candidates must answer these to apply. Separate questions with a pipe <code>|</code> symbol.</p>
                        <textarea class="form-control" name="screening_questions" rows="2" 
                                  placeholder="e.g. Do you have a bike? | Are you willing to travel?">{{ form_data.screening_questions if form_data else '' }}</textarea>
                    </div>

                    <div class="mb-4">
                        <label class="form-label text-muted small">Monthly Salary (INR)</label>
                        <div class="input-group">
                            <span class="input-group-text bg-dark border-secondary text-white">â‚¹</span>
                            <input type="text" class="form-control" name="salary" placeholder="e.g. 40000" value="{{ predicted_salary if predicted_salary else '' }}">
                            <button class="btn btn-outline-light" type="submit" name="predict" value="true">AI Predict</button>
                        </div>
                        {% if ai_reason %}
                            <div class="mt-2 p-2 border border-info rounded bg-info bg-opacity-10">
                                <small class="text-info"><i class="fas fa-robot me-1"></i> {{ ai_reason }}</small>
                            </div>
                        {% endif %}
                    </div>

                    <button type="submit" class="btn btn-primary w-100 py-2">Publish Job</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Keep the Leaflet script from previous response -->
{% endblock %}